!function(t){function e(t,e,i,s){try{return t.insertRule?t.insertRule(e+"{"+i+"}",s):t.addRule(e,i,s)}catch(n){}}function i(t,e){var i=t.className,s=""!=i?" ":"",n=i+s+e;t.className=n}function s(t,e){var i=" "+t.className+" ";i=i.replace(/(\s+)/gi," ");var s=i.replace(" "+e+" "," ");s=s.replace(/(^\s+)|(\s+$)/g,""),t.className=s}function n(t){var e=document.createElement("link");e.rel="stylesheet",e.type="text/css",e.href=t,document.getElementsByTagName("head")[0].appendChild(e)}function o(t,e,i){if(t.indexOf("?")!=-1){var s=new RegExp("(\\?|&"+e+")=[^&]*");t=s.test(t)?t.replace(s,"$1="+i):t+"&"+e+"="+i}else t=t+"?"+e+"="+i;return t}function r(t,e){for(var i in e)t=o(t,encodeURIComponent(i),encodeURIComponent(e[i]));return t}function a(t){return document.createElement(t)}function c(t){return y||(y=this.init(t))}function h(){return window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight}function p(){return document.documentElement.scrollTop||window.pageYOffset||document.body.scrollTop}function d(t){var e,i,s=0,n=0,o=t.getPTPpos(),r=t.getPTPsize(),a=h(),c=p(),d=0;return d=o[1]-c,d>=t.sizeSC.height/2&&a-d-r[1]/2>=t.sizeSC.height/2?(s=o[1]+r[1]/2-t.sizeSC.height/2,n=o[0]+45,e="top: 50%;",i="top: 50%;"):d<=t.sizeSC.height/2?(s=o[1]-d,n=o[0]+45,e="top: "+(d+r[1]/2)/t.sizeSC.height*100+"%;",i=e):a-d>=r[1]&&a-d-r[1]/2<=t.sizeSC.height/2?(s=a-t.sizeSC.height+c,n=o[0]+45,e="top: "+(t.sizeSC.height-(a-d-r[1]/2))/t.sizeSC.height*100+"%;",i=e):a-d<=r[1]?(s=o[1]+r[1]-t.sizeSC.height,n=o[0]+45,e="top: "+(t.sizeSC.height-r[1]/2)/t.sizeSC.height*100+"%;",i=e):(s=o[1]+r[1]/2-t.sizeSC.height/2,n=o[0]+45,e="top: 50%;",i="top: 50%;"),[s,n,e,i]}function l(t){t.src="about:blank",t.parentNode&&t.parentNode.removeChild(t),t.onload=null}function u(t,e){if(t=parseInt(t,10),e=parseInt(e,10),1==t||2==t)switch(e){case 1:return F.click;case 4:return F.piece;case 7:return F.coordinate;case 8:return F.slide;case 9:return F.slidePuzzle;case 10:return F.new_slidePuzzle;case 11:return F.vtt;case 12:return F.f_limit}return F["char"]}function m(t,e){return!(1!=t&&2!=t||10!=e&&11!=e&&12!=e)}function g(t,e){return!(1!=t&&2!=t||10!=e&&11!=e)}function f(t,e){return(1==t||2==t)&&12==e}var y,w=function(t){var e=document.createElement("b");return e.innerHTML="<!--[if IE "+t+"]><i></i><![endif]-->",e.getElementsByTagName("i")&&1===e.getElementsByTagName("i").length},b=!!window.ActiveXObject,v=b&&7==document.documentMode,C=b&&8==document.documentMode,x={preTrigerPoint:"preTrigerPoint",securityCode:"securityCode"},_=function(t,e){return t.currentStyle?t.currentStyle[e]:document.defaultView.getComputedStyle(t,!1)[e]},S=function(t){return function(e){return Object.prototype.toString.call(e)=="[object "+t+"]"}},I=S("Object"),E=S("Function"),z=function(t,e){if(t&&e){if(I(e)){for(var i in e)t.style[i]=e[i];return e}return _(t,e)}},T=function(t){if("undefined"!=typeof t.offsetParent){for(var e=0,i=0;t;t=t.offsetParent){var s=_(t,"borderLeftWidth");s=s&&s.indexOf("px")>-1?parseInt(s,10):0;var n=_(t,"borderTopWidth");n=n&&n.indexOf("px")>-1?parseInt(n,10):0,C&&(s=n=0),e+=t.offsetLeft+s,i+=t.offsetTop+n}return[e,i]}return[t.x,t.y]},P=function(t){var e=z(t,"width"),i=z(t,"height");return[parseInt(e,10),parseInt(i,10)]},k=function(t,e,i){i=i||!1;var s={};for(var n in e)t[n]=e[n];if(i){for(var n in t)s[n]=t[n];return s}return t},B=function(t){var e=window.document.getElementsByTagName("script")[0],i=window.document.createElement("script"),s=t.callback||"callback",n="_aq_"+Math.floor(1e6*Math.random()),o=window[n]=t.success||function(){},a=t.url,c={};c[s]=n,t.data&&(c=k(c,t.data)),a=r(a,c),i.async=t.async||!0,i.src=a,i.onload=function(){i&&e.parentNode&&e.parentNode.removeChild(i),o=null},e.parentNode.insertBefore(i,e)},F={"char":{btn_width:298,height:152,width:300},click:{btn_width:326,height:483,width:328},coordinate:{btn_width:298,width:300,height:277},piece:{height:516,btn_width:362,width:366},slide:{height:260,width:300,btn_width:298},slidePuzzle:{height:232,width:300,btn_width:298},new_slidePuzzle:{height:360,width:360,btn_width:298},vtt:{height:360,width:360,btn_width:298},f_limit:{height:230,width:300,btn_width:298},"default":{btn_width:350}},H=['content: "";',"height: 0;","width: 0;","position: absolute;","left: -17px;","top: 50%;","margin-top: -9.5px;","border-left: 9px solid transparent;","border-top: 9px solid transparent;","border-bottom: 9px solid transparent;","border-right: 9px solid rgba(63, 63, 63, 0.1);","z-index: 0;"],O=['content: "";',"height: 0;","width: 0;","position: absolute;","left: -17px;","top: 50%;","margin-top: -9.5px;","border-left: 9px solid transparent;","border-top: 9px solid transparent;","border-bottom: 9px solid transparent;","border-right: 9px solid #fff;","z-index: 1;"],W={minHeight:40,minWidth:230},N={height:40,width:300},A={height:300,width:400},R={type:"point",ele:document.body,src:"",uin:"",capcd:"",lang:"2052",fb:1,startFn:function(){},endFn:function(){}},L={ERR_CODE_SUC:0,ERR_CODE_BACK:1,ERR_CODE_CLOSE:2};c.prototype={init:function(t){return this.opts=k(R,t||{}),this.initOptions(),this.listenFunc=[],this.readyFunc=[],this.msg=new TCapMsg("parent"),this.initListener(),this.create(),this.sess="",this},initOptions:function(){this.ele=this.opts.ele,this.src=this.opts.src,this.ticket="",this.randstr="",this.sizeSC=k({},A),this.securityIframe="",this.opts.firstvrytype&&2==this.opts.firstvrytype&&(this.src=this.opts.slide_src)},getSrc:function(){var t=this;B({url:r(t.opts.s_type,{uid:this.opts.uin,cap_cd:this.opts.capcd,lang:this.opts.lang}),success:function(e){u(e.capclass,e.subcapclass);captype=e.capclass,subcaptype=e.subcapclass;var i=t.opts.domain+"/"+e.src_1+t.opts.s_type_suffix+"&sess="+e.sess+"&theme="+t.opts.theme+"&sid="+e.sid;i=r(i,{showtype:"popup",fb:t.opts.fb,forcestyle:t.opts.forcestyle});var s=window.document.getElementById("tcaptcha_popup");s.src=i}})},create:function(){var t=this;switch(this.opts.type){case"point":t.createPreTrigerPoint();break;case"embed":if(window.document.getElementById("tcaptcha_load")){var e=window.document.getElementById("tcaptcha_load");e.style.display="none"}B({url:r(t.opts.s_type,{uid:this.opts.uin,cap_cd:this.opts.capcd,lang:this.opts.lang}),success:function(e){var i=u(e.capclass,e.subcapclass);captype=e.capclass,subcaptype=e.subcapclass,t.sess=e.sess;var s=t.opts.domain+"/"+e.src_1+t.opts.s_type_suffix+"&sess="+e.sess+"&theme="+t.opts.theme+"&sid="+e.sid;s=r(s,{noBorder:"noborder",fb:t.opts.fb,forcestyle:t.opts.forcestyle}),t.createSecurityCode(s,i,captype,subcaptype,t.opts.ele)}});break;case"popup":if(window.document.getElementById("tcaptcha_load")){var e=window.document.getElementById("tcaptcha_load");e.style.display="none"}B({url:r(t.opts.s_type,{uid:this.opts.uin,cap_cd:this.opts.capcd,lang:this.opts.lang}),success:function(e){var i=u(e.capclass,e.subcapclass);captype=e.capclass,subcaptype=e.subcapclass;var s=t.opts.domain+"/"+e.src_1+t.opts.s_type_suffix+"&sess="+e.sess+"&theme="+t.opts.theme+"&sid="+e.sid;s=r(s,{showtype:"popup",fb:t.opts.fb,forcestyle:t.opts.forcestyle}),1==m(captype,subcaptype)?t.createSecurityCode(s,{width:i.width,height:i.height},captype,subcaptype,document.body):t.createSecurityCode(s,{width:i.width,height:i.height+40},captype,subcaptype,document.body)}})}},createPreTrigerPoint:function(){this.wrap="",this.preTrigerPoint&&this.nullIframe(!0);var t=document.createElement("div");t.id="loading_animation";var e=this.opts.htdoc_path+"/loading_grey.gif",i=document.createElement("iframe");i.setAttribute("frameborder","0",0),i.setAttribute("border","0"),i.marginheight=0,i.marginwidth=0,i.setAttribute("marginheight","0",0),i.setAttribute("marginwidth","0",0),i.scrolling="no";var s=_(this.ele,"width"),n=_(this.ele,"height"),o=0;s&&"auto"!=s?parseInt(s,10)<W.minWidth?(this.clientW=W.minWidth+"px",o=W.minWidth-2+"px"):(this.clientW=s,o=parseInt(s,10)-2+"px"):(this.clientW="100%",o=C?"99%":"100%"),!n||"auto"==n||parseInt(n,10)<W.minHeight?this.clientH=W.minHeight+"px":this.clientH=n;var a={width:this.clientW,height:this.clientH,border:"1px solid #e7e7e7",position:"relative",borderRadius:"2px",lineHeight:this.clientH,boxSizing:"border-box",background:"url("+e+") center no-repeat"};z(t,a);var c={width:o,height:parseInt(this.clientH,10)-2+"px",border:"none",position:"relative",minHeight:W.minHeight-2+"px",minWidth:W.minWidth-2+"px",zIndex:10};if(this.opts.firstvrytype&&2==this.opts.firstvrytype&&(this.clientW=N.width+"px",this.clientH=N.height+"px",c={width:this.clientW,height:this.clientH,border:"none",position:"relative",minHeight:this.clientH,minWidth:this.clientW,zIndex:10}),z(i,c),this.src){this.opts.themeColor&&(this.src=r(this.src,{color:this.opts.themeColor}));var h=0;this.clientH.length>2&&(h=this.clientH.substr(0,this.clientH.length-2)),this.src=r(this.src,{uid:this.opts.uin,cap_cd:this.opts.capcd,height:h,lang:this.opts.lang,fb:this.opts.fb,theme:this.opts.theme,rnd:Math.floor(1e6*Math.random())}),i.src=this.src}this.preTrigerPoint=i,this.wrap=t,this.wrap.appendChild(this.preTrigerPoint),this.ele.appendChild(this.wrap),this.initPreTriggerPointTarget()},initListener:function(){var t=this;this.listenResize(),this.msg.listen(function(e){try{var n="string"==typeof e?JSON.parse(e):e;n=n.message}catch(o){return}var a=1e4;switch(n&&n.type&&(a=n.type),a){case 0:return void t.collapsePreTriggerPoint();case 1:return void(n.size&&t.setSCheight(parseInt(n.size.height,10)));case 2:return void t.send2preTriggerPoint();case 3:if(window.document.getElementById("tcaptcha_container")){var c=window.document.getElementById("tcaptcha_container");window.document.body.removeChild(c)}if(window.document.getElementById("tcaptcha_transform")){var h=window.document.getElementById("tcaptcha_transform");document.body.removeChild(h)}if(t.opts.startFn(),n&&n.ticket){t.ticket=n.ticket,t.randstr=n.randstr;for(var p=0,d=t.listenFunc.length;p<d;p++)"embed"==t.opts.type&&t.opts.keepOpen?(t.listenFunc[p]({ret:0,ticket:n.ticket,randstr:n.randstr}),t.opts.endFn()):t.closeSecurityCode(function(){t.listenFunc[p]({ret:0,ticket:n.ticket,randstr:n.randstr})});t.listenFunc.length||("embed"==t.opts.type&&t.opts.keepOpen?t.opts.endFn():t.closeSecurityCode());parseInt(t.clientW,10)>W.minWidth?parseInt(t.clientW,10):W.minWidth;if("point"==t.opts.type)if(n.noVerify)setTimeout(function(){var e={border:"1px solid #42dd18"};z(window.document.getElementById("loading_animation"),e),t.send2preTriggerPoint(JSON.stringify({message:{type:"success"}}))},1e3);else{var l={border:"1px solid #42dd18"};z(window.document.getElementById("loading_animation"),l),t.send2preTriggerPoint(JSON.stringify({message:{type:"success"}}))}}else{if(n&&n.src){var f=u(n.captype,n.subcaptype);t.createSecurityCode(n.src,f,n.captype,n.subcaptype,document.body)}t.securityIframe&&t.setPosition(t.securityIframe)}return;case 4:return void t.send2securityCode(JSON.stringify({message:{type:n.task}}));case 5:return void t.send2preTriggerPoint(JSON.stringify({message:{type:n.task}}));case 6:if("embed"==t.opts.type&&window.document.getElementById("cap_iframe")){var y=window.document.getElementById("cap_iframe");return void window.document.body.removeChild(y)}if(window.document.getElementById("tcaptcha_container")){var c=window.document.getElementById("tcaptcha_container");window.document.body.removeChild(c)}if(t.listenFunc.length)for(var p=0,d=t.listenFunc.length;p<d;p++)t.closeSecurityCode(function(){t.listenFunc[p]({ret:L.ERR_CODE_CLOSE,ticket:"",randstr:""})});else t.closeSecurityCode();return;case 7:var l={height:n.size.height+"px",width:n.size.width+"px"};return z(t.securityIframe,l),void t.setPosition(t.securityIframe);case 8:return t.sess=n.sess,void B({url:r(t.opts.s_type,{uid:t.opts.uin,cap_cd:t.opts.capcd,lang:t.opts.lang,sess:t.sess}),success:function(e){switch(t.opts.type){case"embed":var i=u(e.capclass,e.subcapclass);1!=captype&&2!=captype||10!=subcaptype||(i={width:300,height:230,btn_width:298}),t.sess=e.sess;var s=t.opts.domain+"/"+e.src_1+t.opts.s_type_suffix+"&sess="+e.sess+"&theme="+t.opts.theme+"&sid="+e.sid;s=r(s,{noBorder:"noborder",fb:t.opts.fb,forcestyle:t.opts.forcestyle}),t.replaceSccurityCode(s,i);break;case"popup":var i=u(e.capclass,e.subcapclass);t.sess=e.sess;var s=t.opts.domain+"/"+e.src_1+t.opts.s_type_suffix+"&sess="+e.sess+"&theme="+t.opts.theme+"&sid="+e.sid;s=r(s,{showtype:"popup",fb:t.opts.fb}),1==m(captype,subcaptype)?t.replaceSccurityCode(s,i):t.replaceSccurityCode(s,{width:i.width,height:i.height+40});break;case"point":var i=u(e.capclass,e.subcapclass),s=t.opts.domain+"/"+e.src_1+t.opts.s_type_suffix+"&sess="+e.sess+"&theme="+t.opts.theme+"&sid="+e.sid+"&firstvrytype=1";t.replaceSccurityCode(s,i);var n=window.document.getElementById("tcaptcha_container"),o={width:i.width+"px",height:i.height+"px"};z(n,o),t.setDivPosition(n)}}});case 9:return window.document.getElementById("loading_animation")&&setTimeout(function(){window.document.getElementById("loading_animation").style.background="none"},100),void("point"==t.opts.type&&t.send2preTriggerPoint(JSON.stringify({message:{type:"triggerSuccess"}})));case 10:if(t.readyFunc)for(var p=0,d=t.readyFunc.length;p<d;p++)t.readyFunc[p]&&t.readyFunc[p]();return;case 11:return void(t._div&&(s(t._div,"shake"),setTimeout(function(){i(t._div,"shake")},200)));case 12:return void(t._div&&s(t._div,"shake"));case 13:if("embed"==t.opts.type&&window.document.getElementById("cap_iframe")){var y=window.document.getElementById("cap_iframe");window.document.body.removeChild(y)}else if(window.document.getElementById("tcaptcha_container")){var c=window.document.getElementById("tcaptcha_container");window.document.body.removeChild(c)}if(window.document.getElementById("tcaptcha_transform")){var h=window.document.getElementById("tcaptcha_transform");document.body.removeChild(h)}if(t.listenFunc.length)for(var p=0,d=t.listenFunc.length;p<d;p++)t.closeSecurityCode(function(){t.listenFunc[p]({ret:L.ERR_CODE_CLOSE,ticket:"",randstr:""})});else t.closeSecurityCode();return void(1==n.neednotify&&t.send2preTriggerPoint(JSON.stringify({message:{type:"closePopup"}})));case 14:return"point"==t.opts.type&&t.send2preTriggerPoint(JSON.stringify({message:{type:"loadDone"}})),void(document.getElementById("tcaptcha_container")&&(z(document.getElementById("tcaptcha_container"),{display:"block",zoom:1}),setTimeout(function(){i(document.getElementById("tcaptcha_container"),"show"),z(t.securityIframe,{zoom:1})},16)));case 15:if("point"==t.opts.type){var c=window.document.getElementById("tcaptcha_container");if(window.document.body.removeChild(c),t.send2preTriggerPoint(JSON.stringify({message:{type:"fLimit"}})),t.listenFunc.length)for(var p=0,d=t.listenFunc.length;p<d;p++)t.closeSecurityCode(function(){t.listenFunc[p]({ret:L.ERR_CODE_CLOSE,ticket:"",randstr:""})});else t.closeSecurityCode()}else if("popup"==t.opts.type&&g(captype,subcaptype)){var b=window.document.getElementById("transform_close");t.getSrc();var x=window.document.getElementById("tcaptcha_popup"),_=window.document.getElementById("transform_text");x.style.visibility="hidden",w(6)||v||C?b.attachEvent("onclick",t.destroyAll):b.addEventListener("click",t.destroyAll),setTimeout(function(){_.innerHTML=_.innerHTML.replace(/2/,"1")},1e3),setTimeout(function(){x.style.visibility="visible",_.innerHTML=_.innerHTML.replace(/1/,"2")},2e3)}else t.refresh()}})},initPreTriggerPointTarget:function(){this.msg.addTarget(this.preTrigerPoint.contentWindow,x.preTrigerPoint)},replaceSccurityCode:function(t,e){this.sizeSC.height=e&&e.height?e.height:this.sizeSC.height,this.sizeSC.width=e&&e.width?e.width:this.sizeSC.width;var i=this;this.opts.themeColor&&(t=r(t,{color:this.opts.themeColor})),this.opts.type&&(t=r(t,{showtype:this.opts.type})),t=r(t,{uid:this.opts.uin,cap_cd:this.opts.capcd,lang:this.opts.lang,fb:this.opts.fb,rnd:Math.floor(1e6*Math.random())}),this.securityIframe.src=t;var s={height:this.sizeSC.height+"px",width:this.sizeSC.width+"px"};z(this.securityIframe,s),this.setPosition(i.securityIframe)},createSecurityCode:function(t,e,i,s,o){var c="embed"==this.opts.type?"relative":"absolute";if("popup"==this.opts.type&&this.opts.pos&&this.opts.pos.length>0)for(var h=["absolute","fixed","static","relative"],p=0;p<h.length;p++)if(this.opts.pos===h[p]){c=this.opts.pos;break}this.sizeSC.height=e&&e.height?e.height:this.sizeSC.height,this.sizeSC.width=e&&e.width?e.width:this.sizeSC.width;var d=this;if(this.opts.themeColor&&(t=r(t,{color:this.opts.themeColor})),this.opts.type&&(t=r(t,{showtype:this.opts.type})),t=r(t,{uid:this.opts.uin,cap_cd:this.opts.capcd,lang:this.opts.lang,fb:this.opts.fb,rnd:Math.floor(1e6*Math.random())}),this.hasSecurityCode()){this.securityIframe.src=t;var l={height:this.sizeSC.height+"px",width:this.sizeSC.width+"px"};return z(this.securityIframe,l),void this.setPosition(d.securityIframe)}var u=this.opts.htdoc_path;if(n(u+"/tcaptcha_animation.css?v=1.0.0"),"point"==this.opts.type){var m=a("div");m.className="tcaptcha-container",m.id="tcaptcha_container",this._div=m;var l={width:this.sizeSC.width+"px",height:this.sizeSC.height+"px",border:"1px solid #e5e5e5",position:"absolute",left:"0px",top:"0px",display:"none",zIndex:2000000001};z(m,l);var y=document.createElement("iframe");y.setAttribute("frameborder","0",0),y.setAttribute("border","0"),y.marginheight=0,y.marginwidth=0,y.setAttribute("marginheight","0",0),y.setAttribute("marginwidth","0",0),y.scrolling="no";var c="embed"==this.opts.type?"relative":"absolute";if("popup"==this.opts.type&&this.opts.pos&&this.opts.pos.length>0)for(var h=["absolute","fixed","static","relative"],p=0;p<h.length;p++)if(this.opts.pos===h[p]){c=this.opts.pos;break}z(y,{display:"block",width:"100%",height:"100%",border:"0px",background:"#fff",visibility:"visible"}),this.securityIframe=y,m.appendChild(y),o.appendChild(m),y.src=t,this.setDivPosition(m),this.initSecurityCodeTarget()}else if("popup"==this.opts.type&&g(i,s)){var m=a("div");m.className="tcaptcha-transform",m.id="tcaptcha_transform",this._div=m;var l={width:this.sizeSC.width+"px",height:this.sizeSC.height+"px",border:"1px solid #e5e5e5",position:"absolute",left:"0px",top:"0px",visibility:"visible",zIndex:2e4,fontFamily:"Helvtical,microsoft yahei,sans-serif",backgroundColor:"#fff"};z(m,l);var b=a("div");if(w(6))var v=this.opts.htdoc_path+"/transform-rfie.png";else var v=this.opts.htdoc_path+"/transform-refresh.png";var C={position:"absolute",height:"70px",width:"100%",marginTop:"95px",background:"url("+v+") center no-repeat",backgroundPosition:"50% 32%",zIndex:-1};z(b,C),m.appendChild(b);var x=a("div");x.id="transform_close";var v=this.opts.htdoc_path+"/transform-close.png",_={position:"absolute",height:"22px",width:"22px",cursor:"pointer",marginTop:"319.3px",marginLeft:"320px",background:"url("+v+") center no-repeat",zIndex:-1};z(x,_),m.appendChild(x);var S=a("p");S.className="transform-header",S.id="transform_header",this._ph=S,"1028"==this.opts.lang?S.innerText="嘗試太多了":"1033"==this.opts.lang?S.innerText="Too many refreshes":S.innerText="尝试太多了";var I={position:"absolute",width:"100%",fontSize:"18px",textAlign:"center",marginTop:"170px",zIndex:-1};z(S,I);var E=a("p");E.className="transform-text",E.id="transform_text",this._pt=E,"1028"==this.opts.lang?E.innerText="2s後自動為您刷新驗證碼":"1033"==this.opts.lang?E.innerText="Wait 2 sec to reload Captcha.":E.innerText="2s后自动为您刷新验证码";var T={position:"absolute",width:"100%",fontSize:"15px",textAlign:"center",marginTop:"200px",zIndex:-1};z(E,T),m.appendChild(S),m.appendChild(E);var y=document.createElement("iframe");y.id="tcaptcha_popup",y.setAttribute("frameborder","0",0),y.setAttribute("border","0"),y.marginheight=0,y.marginwidth=0,y.setAttribute("marginheight","0",0),y.setAttribute("marginwidth","0",0),y.scrolling="no";var c="embed"==this.opts.type?"relative":"absolute";if("popup"==this.opts.type&&this.opts.pos&&this.opts.pos.length>0)for(var h=["absolute","fixed","static","relative"],p=0;p<h.length;p++)if(this.opts.pos===h[p]){c=this.opts.pos;break}z(y,{display:"block",width:this.sizeSC.width+"px",height:this.sizeSC.height+"px",left:"0px",top:"0px",background:"#fff",zIndex:2000000001}),this.securityIframe=y,m.appendChild(y),o.appendChild(m),y.src=t,this.setDivPosition(m),this.initSecurityCodeTarget()}else{var y=document.createElement("iframe");y.setAttribute("frameborder","0",0),y.setAttribute("border","0"),y.marginheight=0,y.marginwidth=0,y.setAttribute("marginheight","0",0),y.setAttribute("marginwidth","0",0),y.scrolling="no";var c="embed"==this.opts.type?"relative":"absolute";if("popup"==this.opts.type&&this.opts.pos&&this.opts.pos.length>0)for(var h=["absolute","fixed","static","relative"],p=0;p<h.length;p++)if(this.opts.pos===h[p]){c=this.opts.pos;break}if("embed"!=this.opts.type||1!=i&&2!=i||10!=s)if("popup"==this.opts.type&&f(i,s))var l={display:"block",width:this.sizeSC.width+"px",height:this.sizeSC.height+"px",border:"1px solid #e5e5e5",position:"absolute",left:"0px",top:"0px",background:"#fff",zIndex:2000000001};else var l={width:this.sizeSC.width+"px",height:this.sizeSC.height+"px",border:"0px",position:c,left:"0px",top:"0px",zIndex:2000000001};else var l={width:"300px",height:"230px",border:"0px",position:c,left:"0px",top:"0px",zIndex:2000000001};z(y,l),this.securityIframe=y,o.appendChild(y),y.src=t,this.setPosition(y),this.initSecurityCodeTarget()}},hasSecurityCode:function(){var t=!!this.securityIframe&&this.securityIframe;return t},initSecurityCodeTarget:function(){this.msg.addTarget(this.securityIframe.contentWindow,x.securityCode)},destroyAll:function(){if(window.document.getElementById("tcaptcha_transform")){var t=window.document.getElementById("tcaptcha_transform");document.body.removeChild(t)}},destroy:function(){if(y){if(this.closeSecurityCode(),this.listenFunc=[],this.readyFunc=[],this.msg.clear(),this.clearContainer(),this.ele="",y="",window.document.getElementById("tcaptcha_container")){var t=window.document.getElementById("tcaptcha_container");document.body.removeChild(t)}if(window.document.getElementById("tcaptcha_transform")){var e=window.document.getElementById("tcaptcha_transform");document.body.removeChild(e)}}},refresh:function(t){if(window.document.getElementById("tcaptcha_container")){var e=window.document.getElementById("tcaptcha_container");document.body.removeChild(e)}y&&(this.closeSecurityCode(),this.clearContainer(),this.initOptions(),t&&I(t)&&(t.uin&&(this.opts.uin=t.uin),t.capcd&&(this.opts.capcd=t.capcd)),this.create())},clearContainer:function(){"popup"!=this.opts.type&&this.ele&&(this.ele.innerHTML="")},setSrc:function(t){this.tpl.src=t},listen:function(t,e){this.listenFunc.push(t),this.readyFunc.push(e)},clear:function(){this.listenFunc.length=0,this.readyFunc.length=0},send2preTriggerPoint:function(t){if("point"==this.opts.type){var e=x.preTrigerPoint;this.msg.targets[e].send(t)}},send2securityCode:function(t){var e=x.securityCode;this.msg.targets[e].send(t)},setSCheight:function(t){z(this.securityIframe,{height:t+"px"}),this.sizeSC.height=t,this.setPosition(this.securityIframe)},getPTPpos:function(){return T(this.preTrigerPoint)},getSCsize:function(){return[this.sizeSC.width,this.sizeSC.height]},getPTPsize:function(){return P(this.preTrigerPoint)},setPosition:function(t){if("embed"!=this.opts.type){var e=0,i=0;if("popup"==this.opts.type){var s=this.getSCsize(),n=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,o=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;e=(o-s[1])/2,i=(n-s[0])/2}if("point"==this.opts.type){var r=d(this);e=r[0],i=r[1]}return z(t,{top:e+"px",left:i+"px"})}},setDivPosition:function(t){if("embed"!=this.opts.type){var i=0,s=0;if("popup"==this.opts.type){var n=this.getSCsize(),o=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,r=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;i=(r-n[1])/2,s=(o-n[0])/2}if("point"==this.opts.type){var a=d(this);i=a[0],s=a[1],H[5]=a[2],O[5]=a[3];var c=document.createElement("style");c.rel="stylesheet",c.href="style.css",c.type="text/css";var h=document.getElementsByTagName("body")[0];h.appendChild(c),setTimeout(function(){e(document.styleSheets[document.styleSheets.length-1],".tcaptcha-container:before",H.join(""),0),e(document.styleSheets[document.styleSheets.length-1],".tcaptcha-container:after",O.join(""),0)},1)}return z(t,{top:i+"px",left:s+"px"})}},closeSecurityCode:function(t){this.opts.endFn(),this.securityIframe&&this.nullIframe(),E(t)&&t(),window.CollectGarbage&&window.CollectGarbage()},listenResize:function(){var t=this;window.onresize=function(){t.securityIframe&&t.setPosition(t.securityIframe),window.document.getElementById("tcaptcha_container")&&t.setDivPosition(window.document.getElementById("tcaptcha_container"))}},getTicket:function(){return{ticket:this.ticket,randstr:this.randstr}},collapsePreTriggerPoint:function(){C||z(this.preTrigerPoint,{width:this.clientW})},start:function(t){this.opts.startFn=t},end:function(t){this.opts.endFn=t},nullIframe:function(t){return t?(l(this.preTrigerPoint),void(this.preTrigerPoint=null)):(l(this.securityIframe),void(this.securityIframe=null))}},t.AqSCode=c}(window);